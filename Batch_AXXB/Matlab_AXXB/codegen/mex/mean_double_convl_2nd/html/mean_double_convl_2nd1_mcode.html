<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">% This fucntion calculate the 2nd order approximation of the mean of the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% convolution of two probability density functions on SE(3).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Input: M1_hat and M2_hat denotes the mean before orthogonalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% Future Work: To be determined which is the better M12</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T6U3">M123_f</span> = mean_double_convl_2nd(<span class="var type1" id="S3T1U6">X1</span>, <span class="var type1" id="S4T1U7">X2</span>, <span class="var type1" id="S5T1U8">X3</span>, <span class="var type1" id="S6T4U9">s1</span>, <span class="var type1" id="S7T4U10">s2</span>, <span class="var type1" id="S8T4U11">s3</span>, <span class="var type1" id="S9T5U12">n_search</span>, <span class="var type1" id="S10T2U13">diff</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S11T2U16">n1</span> = <span class="mxinfo " id="T2:U12">size(<span class="var type1" id="S3T1U20">X1</span>,2)/4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S13T2U25">n2</span> = <span class="mxinfo " id="T2:U16">size(<span class="var type1" id="S4T1U29">X2</span>,2)/4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="mxinfo " id="T2:U18"><span class="var type1" id="S14T2U34">n3</span> = <span class="mxinfo " id="T2:U20">size(<span class="var type1" id="S4T1U38">X2</span>,2)/4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="keyword">if</span> <span class="var type1" id="S11T2U45">n1</span> ~= <span class="var type1" id="S13T2U46">n2</span> || <span class="var type1" id="S11T2U48">n1</span> ~= <span class="var type1" id="S13T2U49">n2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    fprintf(<span class="string">'Sizes of X1, X2 and X3 do not match.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T2:U26"><span class="var type1" id="S16T2U57">n</span> = <span class="mxinfo " id="T2:U28"><span class="var type1" id="S11T2U58">n1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="mxinfo " id="T6:U30"><span class="var type1" id="S17T6U61">M1</span> = <span class="mxinfo " id="T6:U32"><span class="fcn" id="F574N5:B63">mean_Taylor_2nd</span>( <span class="var type1" id="S3T1U64">X1</span>, <span class="var type1" id="S6T4U65">s1</span>, <span class="var type1" id="S9T5U66">n_search</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo " id="T6:U36"><span class="var type1" id="S19T6U69">M2</span> = <span class="mxinfo " id="T6:U38"><span class="fcn" id="F574N5:B71">mean_Taylor_2nd</span>( <span class="var type1" id="S4T1U72">X2</span>, <span class="var type1" id="S7T4U73">s2</span>, <span class="var type1" id="S9T5U74">n_search</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo " id="T6:U42"><span class="var type1" id="S20T6U77">M3</span> = <span class="mxinfo " id="T6:U44"><span class="fcn" id="F574N5:B79">mean_Taylor_2nd</span>( <span class="var type1" id="S5T1U80">X3</span>, <span class="var type1" id="S8T4U81">s3</span>, <span class="var type1" id="S9T5U82">n_search</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">% This initial guess is not good</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">% M123 = M1*M2*M3; % Initial guess of M12</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">% Another possible way to calculate M123</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T6:U48"><span class="var type1" id="S21T6U85">M123</span> = <span class="mxinfo " id="T6:U50"><span class="mxinfo " id="T6:U51"><span class="var type1" id="S17T6U88">M1</span>*<span class="var type1" id="S19T6U89">M2</span></span>/<span class="var type1" id="S17T6U90">M1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T6:U55"><span class="var type1" id="S2T6U93">M123_f</span> = <span class="var type1" id="S21T6U94">M123</span></span>; <span class="comment">% Final M12</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">% Perturb M_t1 along each direction defined by the Lie algebra element of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">% SE(3)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T2:U58"><span class="var type1" id="S22T2U97">CA</span> = <span class="mxinfo " id="T2:U60">inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo " id="T44:U61"><span class="var type1" id="S24T44U102">E</span> = <span class="mxinfo " id="T44:U63">zeros(<span class="mxinfo " id="T2:U64">4</span>,<span class="mxinfo " id="T2:U65">4</span>,<span class="mxinfo " id="T2:U66">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo " id="T6:U67"><span class="mxinfo " id="T6:U68"><span class="var type1" id="S24T44U111">E</span>(<span class="mxinfo " id="T60:U70">:</span>,<span class="mxinfo " id="T60:U71">:</span>,<span class="mxinfo " id="T2:U72">1</span>)</span> = <span class="mxinfo " id="T6:U73">[<span class="mxinfo " id="T61:U74"><span class="mxinfo " id="T2:U75">0</span>  <span class="mxinfo " id="T2:U76">0</span> <span class="mxinfo " id="T2:U77">0</span> <span class="mxinfo " id="T2:U78">0</span></span>; <span class="mxinfo " id="T61:U79"><span class="mxinfo " id="T2:U80">0</span> <span class="mxinfo " id="T2:U81">0</span> <span class="mxinfo " id="T2:U82">-<span class="mxinfo " id="T2:U83">1</span></span> <span class="mxinfo " id="T2:U84">0</span></span>;  <span class="mxinfo " id="T61:U85"><span class="mxinfo " id="T2:U86">0</span> <span class="mxinfo " id="T2:U87">1</span> <span class="mxinfo " id="T2:U88">0</span> <span class="mxinfo " id="T2:U89">0</span></span>; <span class="mxinfo " id="T61:U90"><span class="mxinfo " id="T2:U91">0</span> <span class="mxinfo " id="T2:U92">0</span> <span class="mxinfo " id="T2:U93">0</span> <span class="mxinfo " id="T2:U94">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo " id="T6:U95"><span class="mxinfo " id="T6:U96"><span class="var type1" id="S24T44U140">E</span>(<span class="mxinfo " id="T60:U98">:</span>,<span class="mxinfo " id="T60:U99">:</span>,<span class="mxinfo " id="T2:U100">2</span>)</span> = <span class="mxinfo " id="T6:U101">[<span class="mxinfo " id="T61:U102"><span class="mxinfo " id="T2:U103">0</span>  <span class="mxinfo " id="T2:U104">0</span> <span class="mxinfo " id="T2:U105">1</span> <span class="mxinfo " id="T2:U106">0</span></span>; <span class="mxinfo " id="T61:U107"><span class="mxinfo " id="T2:U108">0</span> <span class="mxinfo " id="T2:U109">0</span>  <span class="mxinfo " id="T2:U110">0</span> <span class="mxinfo " id="T2:U111">0</span></span>; <span class="mxinfo " id="T61:U112"><span class="mxinfo " id="T2:U113">-<span class="mxinfo " id="T2:U114">1</span></span> <span class="mxinfo " id="T2:U115">0</span> <span class="mxinfo " id="T2:U116">0</span> <span class="mxinfo " id="T2:U117">0</span></span>; <span class="mxinfo " id="T61:U118"><span class="mxinfo " id="T2:U119">0</span> <span class="mxinfo " id="T2:U120">0</span> <span class="mxinfo " id="T2:U121">0</span> <span class="mxinfo " id="T2:U122">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T6:U123"><span class="mxinfo " id="T6:U124"><span class="var type1" id="S24T44U169">E</span>(<span class="mxinfo " id="T60:U126">:</span>,<span class="mxinfo " id="T60:U127">:</span>,<span class="mxinfo " id="T2:U128">3</span>)</span> = <span class="mxinfo " id="T6:U129">[<span class="mxinfo " id="T61:U130"><span class="mxinfo " id="T2:U131">0</span> <span class="mxinfo " id="T2:U132">-<span class="mxinfo " id="T2:U133">1</span></span> <span class="mxinfo " id="T2:U134">0</span> <span class="mxinfo " id="T2:U135">0</span></span>; <span class="mxinfo " id="T61:U136"><span class="mxinfo " id="T2:U137">1</span> <span class="mxinfo " id="T2:U138">0</span>  <span class="mxinfo " id="T2:U139">0</span> <span class="mxinfo " id="T2:U140">0</span></span>;  <span class="mxinfo " id="T61:U141"><span class="mxinfo " id="T2:U142">0</span> <span class="mxinfo " id="T2:U143">0</span> <span class="mxinfo " id="T2:U144">0</span> <span class="mxinfo " id="T2:U145">0</span></span>; <span class="mxinfo " id="T61:U146"><span class="mxinfo " id="T2:U147">0</span> <span class="mxinfo " id="T2:U148">0</span> <span class="mxinfo " id="T2:U149">0</span> <span class="mxinfo " id="T2:U150">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo " id="T6:U151"><span class="mxinfo " id="T6:U152"><span class="var type1" id="S24T44U198">E</span>(<span class="mxinfo " id="T60:U154">:</span>,<span class="mxinfo " id="T60:U155">:</span>,<span class="mxinfo " id="T2:U156">4</span>)</span> = <span class="mxinfo " id="T6:U157">[<span class="mxinfo " id="T61:U158"><span class="mxinfo " id="T2:U159">0</span>  <span class="mxinfo " id="T2:U160">0</span> <span class="mxinfo " id="T2:U161">0</span> <span class="mxinfo " id="T2:U162">1</span></span>; <span class="mxinfo " id="T61:U163"><span class="mxinfo " id="T2:U164">0</span> <span class="mxinfo " id="T2:U165">0</span>  <span class="mxinfo " id="T2:U166">0</span> <span class="mxinfo " id="T2:U167">0</span></span>;  <span class="mxinfo " id="T61:U168"><span class="mxinfo " id="T2:U169">0</span> <span class="mxinfo " id="T2:U170">0</span> <span class="mxinfo " id="T2:U171">0</span> <span class="mxinfo " id="T2:U172">0</span></span>; <span class="mxinfo " id="T61:U173"><span class="mxinfo " id="T2:U174">0</span> <span class="mxinfo " id="T2:U175">0</span> <span class="mxinfo " id="T2:U176">0</span> <span class="mxinfo " id="T2:U177">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T6:U178"><span class="mxinfo " id="T6:U179"><span class="var type1" id="S24T44U226">E</span>(<span class="mxinfo " id="T60:U181">:</span>,<span class="mxinfo " id="T60:U182">:</span>,<span class="mxinfo " id="T2:U183">5</span>)</span> = <span class="mxinfo " id="T6:U184">[<span class="mxinfo " id="T61:U185"><span class="mxinfo " id="T2:U186">0</span>  <span class="mxinfo " id="T2:U187">0</span> <span class="mxinfo " id="T2:U188">0</span> <span class="mxinfo " id="T2:U189">0</span></span>; <span class="mxinfo " id="T61:U190"><span class="mxinfo " id="T2:U191">0</span> <span class="mxinfo " id="T2:U192">0</span>  <span class="mxinfo " id="T2:U193">0</span> <span class="mxinfo " id="T2:U194">1</span></span>;  <span class="mxinfo " id="T61:U195"><span class="mxinfo " id="T2:U196">0</span> <span class="mxinfo " id="T2:U197">0</span> <span class="mxinfo " id="T2:U198">0</span> <span class="mxinfo " id="T2:U199">0</span></span>; <span class="mxinfo " id="T61:U200"><span class="mxinfo " id="T2:U201">0</span> <span class="mxinfo " id="T2:U202">0</span> <span class="mxinfo " id="T2:U203">0</span> <span class="mxinfo " id="T2:U204">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T6:U205"><span class="mxinfo " id="T6:U206"><span class="var type1" id="S24T44U254">E</span>(<span class="mxinfo " id="T60:U208">:</span>,<span class="mxinfo " id="T60:U209">:</span>,<span class="mxinfo " id="T9:U210">6</span>)</span> = <span class="mxinfo " id="T6:U211">[<span class="mxinfo " id="T61:U212"><span class="mxinfo " id="T2:U213">0</span>  <span class="mxinfo " id="T2:U214">0</span> <span class="mxinfo " id="T2:U215">0</span> <span class="mxinfo " id="T2:U216">0</span></span>; <span class="mxinfo " id="T61:U217"><span class="mxinfo " id="T2:U218">0</span> <span class="mxinfo " id="T2:U219">0</span>  <span class="mxinfo " id="T2:U220">0</span> <span class="mxinfo " id="T2:U221">0</span></span>;  <span class="mxinfo " id="T61:U222"><span class="mxinfo " id="T2:U223">0</span> <span class="mxinfo " id="T2:U224">0</span> <span class="mxinfo " id="T2:U225">0</span> <span class="mxinfo " id="T2:U226">1</span></span>; <span class="mxinfo " id="T61:U227"><span class="mxinfo " id="T2:U228">0</span> <span class="mxinfo " id="T2:U229">0</span> <span class="mxinfo " id="T2:U230">0</span> <span class="mxinfo " id="T2:U231">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">% diff = 10^-12;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T2:U232"><span class="var type1" id="S26T2U281">eps</span>  =  <span class="mxinfo " id="T2:U234">0.001</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="mxinfo " id="T2:U235"><span class="var type1" id="S27T2U285">step</span> = <span class="mxinfo " id="T2:U237">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo " id="T2:U238"><span class="var type1" id="S28T2U289">count</span> = <span class="mxinfo " id="T2:U240">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo " id="T2:U241"><span class="var type1" id="S29T2U293">n_step</span> = <span class="mxinfo " id="T2:U243">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T3:U244"><span class="var type1" id="S6T4U298">s1</span> == <span class="mxinfo " id="T2:U246">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo " id="T2:U247"><span class="var type1" id="S30T2U302">m</span> = <span class="mxinfo " id="T2:U249">4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T3:U250"><span class="var type1" id="S6T4U306">s1</span> == <span class="mxinfo " id="T2:U252">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo " id="T2:U253"><span class="var type1" id="S30T2U310">m</span> = <span class="mxinfo " id="T2:U255">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo " id="T2:U256"><span class="var type1" id="S30T2U315">m</span> = <span class="mxinfo " id="T2:U258">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo " id="T2:U259"><span class="var type1" id="S31T2U319">CA1</span> = <span class="mxinfo " id="T2:U261">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T2:U262"><span class="var type1" id="S32T2U323">CA2</span> = <span class="mxinfo " id="T2:U264">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="keyword">while</span>( <span class="mxinfo " id="T3:U265"><span class="mxinfo " id="T2:U266">abs(<span class="var type1" id="S22T2U330">CA</span>)</span> &gt; <span class="var type1" id="S10T2U331">diff</span></span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T2:U269"><span class="var type1" id="S28T2U334">count</span> = <span class="mxinfo " id="T2:U271"><span class="var type1" id="S28T2U336">count</span> + <span class="mxinfo " id="T2:U273">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="comment">% Adjust the step length</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T3:U274"><span class="mxinfo " id="T2:U275">abs(<span class="var type1" id="S22T2U343">CA</span>)</span> &gt; <span class="mxinfo " id="T2:U277">100</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo " id="T2:U278"><span class="var type1" id="S26T2U347">eps</span> = <span class="mxinfo " id="T2:U280">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T3:U281"><span class="mxinfo " id="T2:U282">abs(<span class="var type1" id="S22T2U354">CA</span>)</span> &gt; <span class="mxinfo " id="T2:U284">1</span></span> &amp;&amp; <span class="mxinfo " id="T3:U285"><span class="mxinfo " id="T2:U286">abs(<span class="var type1" id="S22T2U359">CA</span>)</span> &lt; <span class="mxinfo " id="T2:U288">100</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">        <span class="mxinfo " id="T2:U289"><span class="var type1" id="S26T2U363">eps</span> = <span class="mxinfo " id="T2:U291">0.1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T3:U292"><span class="mxinfo " id="T2:U293">abs(<span class="var type1" id="S22T2U370">CA</span>)</span> &gt; <span class="mxinfo " id="T2:U295">0.01</span></span> &amp;&amp; <span class="mxinfo " id="T3:U296"><span class="mxinfo " id="T2:U297">abs(<span class="var type1" id="S22T2U375">CA</span>)</span> &lt; <span class="mxinfo " id="T2:U299">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T2:U300"><span class="var type1" id="S26T2U379">eps</span> = <span class="mxinfo " id="T2:U302">0.001</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T3:U303"><span class="mxinfo " id="T2:U304">abs(<span class="var type1" id="S22T2U385">CA</span>)</span> &lt; <span class="mxinfo " id="T2:U306">0.01</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">        <span class="mxinfo " id="T2:U307"><span class="var type1" id="S26T2U389">eps</span> = <span class="mxinfo " id="T2:U309">0.0001</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T3:U310"><span class="mxinfo " id="T2:U311">abs(<span class="var type1" id="S22T2U395">CA</span>)</span> &lt; <span class="mxinfo " id="T2:U313"><span class="mxinfo " id="T2:U314">10</span>^-8</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">        <span class="mxinfo " id="T2:U315"><span class="var type1" id="S26T2U402">eps</span> = <span class="mxinfo " id="T2:U317">0.00001</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo " id="T2:U318"><span class="var type1" id="S26T2U407">eps</span> = <span class="mxinfo " id="T2:U320">0.001</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S34T2U411">j</span> = <span class="var type1" id="S30T2U413">m</span>:<span class="mxinfo " id="T2:U323">6</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">        <span class="comment">% disp(step)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">        <span class="mxinfo " id="T6:U324"><span class="var type1" id="S35T6U417">M123_r</span> = <span class="mxinfo " id="T6:U326"><span class="var type1" id="S2T6U419">M123_f</span>*<span class="mxinfo " id="T6:U328">expm( <span class="mxinfo " id="T6:U329"><span class="mxinfo " id="T2:U330"><span class="var type1" id="S27T2U424">step</span>*<span class="var type1" id="S26T2U425">eps</span></span>*<span class="mxinfo " id="T6:U333"><span class="var type1" id="S24T44U427">E</span>(<span class="mxinfo " id="T60:U335">:</span>,<span class="mxinfo " id="T60:U336">:</span>,<span class="var type1" id="S34T2U430">j</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">        <span class="mxinfo " id="T6:U338"><span class="var type1" id="S37T6U433">M123_l</span> = <span class="mxinfo " id="T6:U340"><span class="var type1" id="S2T6U435">M123_f</span>*<span class="mxinfo " id="T6:U342">expm(<span class="mxinfo " id="T6:U343"><span class="mxinfo " id="T2:U344"><span class="mxinfo " id="T2:U345">-<span class="var type1" id="S27T2U441">step</span></span>*<span class="var type1" id="S26T2U442">eps</span></span>*<span class="mxinfo " id="T6:U348"><span class="var type1" id="S24T44U444">E</span>(<span class="mxinfo " id="T60:U350">:</span>,<span class="mxinfo " id="T60:U351">:</span>,<span class="var type1" id="S34T2U447">j</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo " id="T6:U353"><span class="var type1" id="S38T6U450">M123_r_sum</span> = <span class="mxinfo " id="T6:U355">zeros(<span class="mxinfo " id="T2:U356">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo " id="T6:U357"><span class="var type1" id="S39T6U456">M123_l_sum</span> = <span class="mxinfo " id="T6:U359">zeros(<span class="mxinfo " id="T2:U360">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S40T2U462">i</span> = <span class="mxinfo " id="T2:U362">1</span>:<span class="var type1" id="S11T2U465">n1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S41T2U468">k</span> = <span class="mxinfo " id="T2:U365">1</span>:<span class="var type1" id="S13T2U471">n2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S42T2U474">l</span> = <span class="mxinfo " id="T2:U368">1</span>:<span class="var type1" id="S14T2U477">n3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">                    <span class="mxinfo " id="T58:U370"><span class="var type1" id="S43T58U480">X1_i</span> = <span class="mxinfo " id="T58:U372"><span class="var type1" id="S3T1U482">X1</span>(<span class="mxinfo " id="T60:U374">:</span>,<span class="mxinfo " id="T62:U375"><span class="mxinfo " id="T2:U376"><span class="mxinfo " id="T2:U377">(<span class="mxinfo " id="T2:U378"><span class="var type1" id="S40T2U489">i</span>-<span class="mxinfo " id="T2:U380">1</span></span>)*<span class="mxinfo " id="T2:U381">4</span></span> + <span class="mxinfo " id="T2:U382">1</span></span>:<span class="mxinfo " id="T2:U383"><span class="var type1" id="S40T2U494">i</span>*<span class="mxinfo " id="T2:U385">4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">                    <span class="mxinfo " id="T58:U386"><span class="var type1" id="S44T58U498">X2_k</span> = <span class="mxinfo " id="T58:U388"><span class="var type1" id="S4T1U500">X2</span>(<span class="mxinfo " id="T60:U390">:</span>,<span class="mxinfo " id="T62:U391"><span class="mxinfo " id="T2:U392"><span class="mxinfo " id="T2:U393">(<span class="mxinfo " id="T2:U394"><span class="var type1" id="S41T2U507">k</span>-<span class="mxinfo " id="T2:U396">1</span></span>)*<span class="mxinfo " id="T2:U397">4</span></span> + <span class="mxinfo " id="T2:U398">1</span></span>:<span class="mxinfo " id="T2:U399"><span class="var type1" id="S41T2U512">k</span>*<span class="mxinfo " id="T2:U401">4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">                    <span class="mxinfo " id="T58:U402"><span class="var type1" id="S45T58U516">X3_j</span> = <span class="mxinfo " id="T58:U404"><span class="var type1" id="S4T1U518">X2</span>(<span class="mxinfo " id="T60:U406">:</span>,<span class="mxinfo " id="T62:U407"><span class="mxinfo " id="T2:U408"><span class="mxinfo " id="T2:U409">(<span class="mxinfo " id="T2:U410"><span class="var type1" id="S42T2U525">l</span>-<span class="mxinfo " id="T2:U412">1</span></span>)*<span class="mxinfo " id="T2:U413">4</span></span> + <span class="mxinfo " id="T2:U414">1</span></span>:<span class="mxinfo " id="T2:U415"><span class="var type1" id="S42T2U530">l</span>*<span class="mxinfo " id="T2:U417">4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">                    <span class="mxinfo " id="T6:U418"><span class="var type1" id="S38T6U534">M123_r_sum</span> = <span class="mxinfo " id="T6:U420"><span class="var type1" id="S38T6U536">M123_r_sum</span> + <span class="mxinfo " id="T58:U422"><span class="mxinfo " id="T58:U423"><span class="mxinfo " id="T58:U424"><span class="mxinfo " id="T59:U425"><span class="mxinfo " id="T58:U426"><span class="mxinfo " id="T58:U427"><span class="var type1" id="S43T58U543">X1_i</span>*<span class="var type1" id="S44T58U544">X2_k</span></span>*<span class="var type1" id="S45T58U545">X3_j</span></span>/<span class="var type1" id="S35T6U546">M123_r</span></span>*<span class="var type1" id="S43T58U547">X1_i</span></span>*<span class="var type1" id="S44T58U548">X2_k</span></span>*<span class="var type1" id="S45T58U549">X3_j</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">                    <span class="mxinfo " id="T6:U435"><span class="var type1" id="S39T6U552">M123_l_sum</span> = <span class="mxinfo " id="T6:U437"><span class="var type1" id="S39T6U554">M123_l_sum</span> + <span class="mxinfo " id="T58:U439"><span class="mxinfo " id="T58:U440"><span class="mxinfo " id="T58:U441"><span class="mxinfo " id="T59:U442"><span class="mxinfo " id="T58:U443"><span class="mxinfo " id="T58:U444"><span class="var type1" id="S43T58U561">X1_i</span>*<span class="var type1" id="S44T58U562">X2_k</span></span>*<span class="var type1" id="S45T58U563">X3_j</span></span>/<span class="var type1" id="S37T6U564">M123_l</span></span>*<span class="var type1" id="S43T58U565">X1_i</span></span>*<span class="var type1" id="S44T58U566">X2_k</span></span>*<span class="var type1" id="S45T58U567">X3_j</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">        <span class="mxinfo " id="T6:U452"><span class="var type1" id="S46T6U570">M123_r_cost</span> = <span class="mxinfo " id="T6:U454"><span class="mxinfo " id="T6:U455"><span class="var type1" id="S21T6U573">M123</span> - <span class="mxinfo " id="T6:U457"><span class="mxinfo " id="T2:U458">1/4/<span class="var type1" id="S16T2U580">n</span>^2</span>*<span class="var type1" id="S38T6U582">M123_r_sum</span></span></span> - <span class="mxinfo " id="T6:U461"><span class="mxinfo " id="T2:U462">3/4</span>*<span class="var type1" id="S35T6U587">M123_r</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">        <span class="mxinfo " id="T6:U464"><span class="var type1" id="S47T6U590">M123_l_cost</span> = <span class="mxinfo " id="T6:U466"><span class="mxinfo " id="T6:U467"><span class="var type1" id="S21T6U593">M123</span> - <span class="mxinfo " id="T6:U469"><span class="mxinfo " id="T2:U470">1/4/<span class="var type1" id="S16T2U600">n</span>^2</span>*<span class="var type1" id="S39T6U602">M123_l_sum</span></span></span> - <span class="mxinfo " id="T6:U473"><span class="mxinfo " id="T2:U474">3/4</span>*<span class="var type1" id="S37T6U607">M123_l</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T3:U476"><span class="var type1" id="S30T2U611">m</span> == <span class="mxinfo " id="T2:U478">4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            <span class="mxinfo " id="T2:U479"><span class="var type1" id="S31T2U615">CA1</span> = <span class="mxinfo " id="T2:U481"><span class="mxinfo " id="T2:U482">norm(<span class="mxinfo " id="T28:U483"><span class="var type1" id="S46T6U620">M123_r_cost</span>(<span class="mxinfo " id="T63:U485">1:3</span>,<span class="mxinfo " id="T9:U486">4</span>)</span>)</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            <span class="mxinfo " id="T2:U487"><span class="var type1" id="S32T2U628">CA2</span> = <span class="mxinfo " id="T2:U489"><span class="mxinfo " id="T2:U490">norm(<span class="mxinfo " id="T28:U491"><span class="var type1" id="S47T6U633">M123_l_cost</span>(<span class="mxinfo " id="T63:U493">1:3</span>,<span class="mxinfo " id="T9:U494">4</span>)</span>)</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo " id="T3:U495"><span class="var type1" id="S30T2U641">m</span> == <span class="mxinfo " id="T2:U497">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="mxinfo " id="T2:U498"><span class="var type1" id="S31T2U645">CA1</span> = <span class="mxinfo " id="T2:U500"><span class="mxinfo " id="T2:U501">norm(<span class="var type1" id="S46T6U649">M123_r_cost</span>)</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="mxinfo " id="T2:U503"><span class="var type1" id="S32T2U653">CA2</span> = <span class="mxinfo " id="T2:U505"><span class="mxinfo " id="T2:U506">norm(<span class="var type1" id="S47T6U657">M123_l_cost</span>)</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">            <span class="mxinfo " id="T2:U508"><span class="var type1" id="S31T2U662">CA1</span> = <span class="mxinfo " id="T2:U510">-<span class="mxinfo " id="T2:U511">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">            <span class="mxinfo " id="T2:U512"><span class="var type1" id="S32T2U667">CA2</span> = <span class="mxinfo " id="T2:U514">-<span class="mxinfo " id="T2:U515">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T3:U516"><span class="var type1" id="S31T2U674">CA1</span> &lt;= <span class="var type1" id="S32T2U675">CA2</span></span> &amp;&amp; <span class="mxinfo " id="T3:U519"><span class="var type1" id="S31T2U677">CA1</span> &lt; <span class="var type1" id="S22T2U678">CA</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">            <span class="mxinfo " id="T2:U522"><span class="var type1" id="S22T2U681">CA</span> = <span class="var type1" id="S31T2U682">CA1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">            <span class="mxinfo " id="T6:U525"><span class="var type1" id="S2T6U685">M123_f</span> = <span class="var type1" id="S35T6U686">M123_r</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">            <span class="mxinfo " id="T2:U528"><span class="var type1" id="S27T2U689">step</span> = <span class="mxinfo " id="T2:U530">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">            <span class="comment">% fprintf('Found a descent direction along %d \n', j)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">            <span class="comment">% disp(MX1cost)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">            <span class="comment">% disp(CA)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo " id="T3:U531"><span class="var type1" id="S32T2U694">CA2</span> &lt; <span class="var type1" id="S31T2U695">CA1</span></span> &amp;&amp; <span class="mxinfo " id="T3:U534"><span class="var type1" id="S32T2U697">CA2</span> &lt; <span class="var type1" id="S22T2U698">CA</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            <span class="mxinfo " id="T2:U537"><span class="var type1" id="S22T2U701">CA</span> = <span class="var type1" id="S32T2U702">CA2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">            <span class="mxinfo " id="T6:U540"><span class="var type1" id="S2T6U705">M123_f</span> = <span class="var type1" id="S37T6U706">M123_l</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">            <span class="mxinfo " id="T2:U543"><span class="var type1" id="S27T2U709">step</span> = <span class="mxinfo " id="T2:U545">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">            <span class="comment">% fprintf('Found a descent direction along -%d \n', j)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">            <span class="comment">% disp(MX2cost)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">            <span class="comment">% disp(CA)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">            <span class="comment">% fprintf('Not a descent direction along +/-%d \n', j)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T3:U546"><span class="var type1" id="S22T2U715">CA</span> &gt; <span class="mxinfo " id="T2:U548">10</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">                <span class="mxinfo " id="T2:U549"><span class="var type1" id="S27T2U719">step</span> = <span class="mxinfo " id="T2:U551">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">                <span class="mxinfo " id="T2:U552"><span class="var type1" id="S29T2U724">n_step</span> = <span class="mxinfo " id="T2:U554"><span class="var type1" id="S29T2U726">n_step</span> + <span class="mxinfo " id="T2:U556">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T3:U557"><span class="var type1" id="S29T2U731">n_step</span> == (<span class="mxinfo " id="T2:U559"><span class="mxinfo " id="T2:U560"><span class="mxinfo " id="T2:U561">6</span> - <span class="var type1" id="S30T2U736">m</span></span> +<span class="mxinfo " id="T2:U563">1</span></span> )</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">                    <span class="mxinfo " id="T2:U564"><span class="var type1" id="S29T2U740">n_step</span> = <span class="mxinfo " id="T2:U566">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">                    <span class="mxinfo " id="T2:U567"><span class="var type1" id="S27T2U744">step</span> = <span class="mxinfo " id="T2:U569"><span class="var type1" id="S27T2U746">step</span> + <span class="mxinfo " id="T2:U571">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">    fprintf(<span class="string">'Value of the cost function is %f, %f and %f \n'</span>, <span class="var type1" id="S31T2U752">CA1</span>, <span class="var type1" id="S32T2U753">CA2</span>, <span class="var type1" id="S22T2U754">CA</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    <span class="comment">% fprintf('Value of the cost function is %f \n', CA2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="comment">% fprintf('Value of the cost function is %f \n', CA);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T3:U575"><span class="var type1" id="S27T2U758">step</span> == <span class="mxinfo " id="T2:U577">20</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
