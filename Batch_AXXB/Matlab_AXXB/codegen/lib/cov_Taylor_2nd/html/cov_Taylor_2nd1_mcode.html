<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">% This function calculates the 2nd order approximation of the covariance of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% a bunch of matrices based on the Taylor expansion of the matrix logarithm</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% and the definition of mean of a probability density function.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Input: X is a 4 by 4*n cumulation of n rigid body transformations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T7U3">Sigma</span> = cov_Taylor_2nd(<span class="var type1" id="S3T6U6">X</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T6:U3"><span class="var type1" id="S4T6U9">n_search</span> = <span class="mxinfo " id="T6:U5">int16(<span class="mxinfo " id="T1:U6">10^2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="var type0" id="S6T0U17">M_X</span> = <span class="message error" id="M1F1C">mean_Taylor_2nd_mex( <span class="var type1" id="S3T6U20">X</span>, <span class="mxinfo " id="T1:U8">1</span>, <span class="var type1" id="S4T6U22">n_search</span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T1:U10"><span class="var type1" id="S8T1U25">n</span> = <span class="mxinfo " id="T1:U12">size(<span class="var type1" id="S3T6U29">X</span>,2)/4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T7:U14"><span class="var type1" id="S2T7U34">Sigma</span> = <span class="mxinfo " id="T7:U16">zeros(6,6)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="keyword">for</span> <span class="mxinfo " id="T1:U17"><span class="var type1" id="S11T1U41">i</span></span> = <span class="mxinfo " id="T8:U19"><span class="mxinfo " id="T1:U20">1</span>:<span class="mxinfo " id="T1:U21"><span class="var type1" id="S8T1U44">n</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="var type0" id="S12T0U47">X_i</span> = <span class="var type0" id="S3T0U49">X</span>(:,4*(<span class="var type0" id="S11T0U57">i</span>-1)+1:4*<span class="var type0" id="S11T0U62">i</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="var type0" id="S13T0U65">P</span> = ( <span class="var type0" id="S6T0U70">M_X</span>\<span class="var type0" id="S12T0U71">X_i</span> - eye(4) ) - 1/2*( <span class="var type0" id="S6T0U83">M_X</span>\<span class="var type0" id="S12T0U84">X_i</span> - eye(4) )^2;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="var type0" id="S2T0U91">Sigma</span> = <span class="var type0" id="S2T0U93">Sigma</span> + se3_vec( <span class="var type0" id="S13T0U97">P</span> )*se3_vec( <span class="var type0" id="S13T0U101">P</span> )';</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T7:U23"><span class="var type1" id="S2T7U104">Sigma</span> = <span class="mxinfo " id="T7:U25"><span class="mxinfo " id="T1:U26">1/<span class="var type1" id="S8T1U108">n</span></span>*<span class="mxinfo " id="T7:U28"><span class="var type1" id="S2T7U109">Sigma</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
