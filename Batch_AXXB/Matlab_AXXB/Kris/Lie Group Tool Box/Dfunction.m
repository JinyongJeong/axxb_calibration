function [Dblock] = Dfunction(A,B)
%[Dblock] = Dfunction(A,B)
%A and B are 3 x 3 matrices
D = zeros(3,3);

a11 = A(1,1);
a12 = A(1,2);
a13 = A(1,3);
a21 = A(2,1);
a22 = A(2,2);
a23 = A(2,3);
a31 = A(3,1);
a32 = A(3,2);
a33 = A(3,3);

b11 = B(1,1);
b12 = B(1,2);
b13 = B(1,3);
b21 = B(2,1);
b22 = B(2,2);
b23 = B(2,3);
b31 = B(3,1);
b32 = B(3,2);
b33 = B(3,3);

D(1,1) = -a33*b22 + a32*b32 + a23*b23 - a22*b33;
D(1,2) = a33*b21 - a32*b31 - a13*b23 + a12*b33;
D(1,3) = -a23*b21 + a22*b31 + a13*b22 - a12*b32;
D(2,1) = a33*b12 - a31*b32 - a23*b13 + a21*b33;
D(2,2) = -a33*b11 + a31*b31 + a13*b13 - a11*b33;
D(2,3) = a23*b11 - a21*b31 - a13*b12 + a11*b32;
D(3,1) = -a32*b12 + a31*b22 + a22*b13 - a21*b23;
D(3,2) = a32*b11 - a31*b21 - a12*b13 + a11*b23;
D(3,3) = -a22*b11 + a21*b21 + a12*b12 - a11*b22;

Dblock = D;

