<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T65U3">X</span>, <span class="var type1" id="S3T28U4">MeanA</span>, <span class="var type1" id="S4T28U5">MeanB</span>, <span class="var type1" id="S5T45U6">SigA</span>, <span class="var type1" id="S6T45U7">SigB</span>] = batchEDSolve(<span class="var type1" id="S7T1U10">A</span>,<span class="var type1" id="S8T1U11">B</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">coder.extrinsic(<span class="string">'distibutionPropsMex_mex'</span>); </span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T45:U8"><span class="var type1" id="S5T45U20">SigA</span> = <span class="mxinfo " id="T45:U10">zeros(<span class="mxinfo " id="T2:U11">6</span>, <span class="mxinfo " id="T2:U12">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T45:U13"><span class="var type1" id="S6T45U27">SigB</span> = <span class="mxinfo " id="T45:U15">zeros(<span class="mxinfo " id="T2:U16">6</span>, <span class="mxinfo " id="T2:U17">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">[<span class="mxinfo " id="T28:U18"><span class="var type1" id="S3T28U35">MeanA</span></span>, <span class="mxinfo " id="T45:U20"><span class="var type1" id="S5T45U36">SigA</span></span>] = <span class="fcn" id="F504N3:B38">distibutionPropsMex</span>(<span class="var type1" id="S7T1U39">A</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">[<span class="mxinfo " id="T28:U23"><span class="var type1" id="S4T28U43">MeanB</span></span>, <span class="mxinfo " id="T45:U25"><span class="var type1" id="S6T45U44">SigB</span></span>] = <span class="fcn" id="F504N3:B46">distibutionPropsMex</span>(<span class="var type1" id="S8T1U47">B</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">[<span class="mxinfo " id="T49:U28"><span class="var type1" id="S12T49U51">VA</span></span>, <span class="mxinfo " id="T2:U30"><span class="mxinfo " id="T2:U31">~</span></span>] = eig(<span class="mxinfo " id="T4:U32"><span class="var type1" id="S5T45U56">SigA</span>(<span class="mxinfo " id="T50:U34">1:3</span>,<span class="mxinfo " id="T50:U35">1:3</span>)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">[<span class="mxinfo " id="T49:U36"><span class="var type1" id="S14T49U66">VB</span></span>, <span class="mxinfo " id="T2:U38"><span class="mxinfo " id="T2:U39">~</span></span>] = eig(<span class="mxinfo " id="T4:U40"><span class="var type1" id="S6T45U71">SigB</span>(<span class="mxinfo " id="T50:U42">1:3</span>,<span class="mxinfo " id="T50:U43">1:3</span>)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T4:U44"><span class="var type1" id="S15T4U80">Q1</span> = <span class="mxinfo " id="T4:U46">eye(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T4:U47"><span class="var type1" id="S17T4U86">Q2</span> = <span class="mxinfo " id="T4:U49">[-1 0 0; 0 -1 0; 0 0 1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T4:U50"><span class="var type1" id="S18T4U104">Q3</span> = <span class="mxinfo " id="T4:U52">[-1 0 0; 0 1 0; 0 0 -1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T4:U53"><span class="var type1" id="S19T4U122">Q4</span> = <span class="mxinfo " id="T4:U55">[1 0 0; 0 -1 0; 0 0 -1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T59:U56"><span class="var type1" id="S20T59U140">Rx_solved</span> = <span class="mxinfo " id="T59:U58">complex(<span class="mxinfo " id="T72:U59">zeros(3,8*3)</span>, <span class="mxinfo " id="T72:U60">zeros(3,8*3)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="comment">% if ~isreal(VA) || ~isreal(VB)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="comment">%     fprintf('SVD of either SigA or SigB is not real.')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="comment">% Rx_solved(:,:,1) = VA*Q1*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="comment">% Rx_solved(:,:,2) = VA*Q2*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="comment">% Rx_solved(:,:,3) = VA*Q3*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="comment">% Rx_solved(:,:,4) = VA*Q4*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="comment">% Rx_solved(:,:,5) = VA*-Q1*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="comment">% Rx_solved(:,:,6) = VA*-Q2*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="comment">% Rx_solved(:,:,7) = VA*-Q3*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="comment">% Rx_solved(:,:,8) = VA*-Q4*VB';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo " id="T49:U61"><span class="mxinfo " id="T49:U62"><span class="var type1" id="S20T59U158">Rx_solved</span>(<span class="mxinfo " id="T50:U64">:</span>,<span class="mxinfo " id="T17:U65"><span class="mxinfo " id="T2:U66">1</span>:<span class="mxinfo " id="T2:U67">3</span></span>)</span> = <span class="mxinfo " id="T49:U68"><span class="mxinfo " id="T49:U69"><span class="var type1" id="S12T49U165">VA</span>*<span class="mxinfo " id="T4:U71"><span class="var type1" id="S15T4U166">Q1</span></span></span>*<span class="mxinfo " id="T49:U73"><span class="var type1" id="S14T49U168">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T49:U75"><span class="mxinfo " id="T49:U76"><span class="var type1" id="S20T59U172">Rx_solved</span>(<span class="mxinfo " id="T50:U78">:</span>,<span class="mxinfo " id="T17:U79"><span class="mxinfo " id="T2:U80">4</span>:<span class="mxinfo " id="T2:U81">6</span></span>)</span> = <span class="mxinfo " id="T49:U82"><span class="mxinfo " id="T49:U83"><span class="var type1" id="S12T49U179">VA</span>*<span class="mxinfo " id="T4:U85"><span class="var type1" id="S17T4U180">Q2</span></span></span>*<span class="mxinfo " id="T49:U87"><span class="var type1" id="S14T49U182">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T49:U89"><span class="mxinfo " id="T49:U90"><span class="var type1" id="S20T59U186">Rx_solved</span>(<span class="mxinfo " id="T50:U92">:</span>,<span class="mxinfo " id="T17:U93"><span class="mxinfo " id="T2:U94">7</span>:<span class="mxinfo " id="T2:U95">9</span></span>)</span> = <span class="mxinfo " id="T49:U96"><span class="mxinfo " id="T49:U97"><span class="var type1" id="S12T49U193">VA</span>*<span class="mxinfo " id="T4:U99"><span class="var type1" id="S18T4U194">Q3</span></span></span>*<span class="mxinfo " id="T49:U101"><span class="var type1" id="S14T49U196">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T49:U103"><span class="mxinfo " id="T49:U104"><span class="var type1" id="S20T59U200">Rx_solved</span>(<span class="mxinfo " id="T50:U106">:</span>,<span class="mxinfo " id="T17:U107"><span class="mxinfo " id="T2:U108">10</span>:<span class="mxinfo " id="T2:U109">12</span></span>)</span> = <span class="mxinfo " id="T49:U110"><span class="mxinfo " id="T49:U111"><span class="var type1" id="S12T49U207">VA</span>*<span class="mxinfo " id="T4:U113"><span class="var type1" id="S19T4U208">Q4</span></span></span>*<span class="mxinfo " id="T49:U115"><span class="var type1" id="S14T49U210">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T49:U117"><span class="mxinfo " id="T49:U118"><span class="var type1" id="S20T59U214">Rx_solved</span>(<span class="mxinfo " id="T50:U120">:</span>,<span class="mxinfo " id="T17:U121"><span class="mxinfo " id="T2:U122">13</span>:<span class="mxinfo " id="T2:U123">15</span></span>)</span> = <span class="mxinfo " id="T49:U124"><span class="mxinfo " id="T49:U125"><span class="var type1" id="S12T49U221">VA</span>*<span class="mxinfo " id="T4:U127">-<span class="var type1" id="S15T4U223">Q1</span></span></span>*<span class="mxinfo " id="T49:U129"><span class="var type1" id="S14T49U225">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T49:U131"><span class="mxinfo " id="T49:U132"><span class="var type1" id="S20T59U229">Rx_solved</span>(<span class="mxinfo " id="T50:U134">:</span>,<span class="mxinfo " id="T17:U135"><span class="mxinfo " id="T2:U136">16</span>:<span class="mxinfo " id="T2:U137">18</span></span>)</span> = <span class="mxinfo " id="T49:U138"><span class="mxinfo " id="T49:U139"><span class="var type1" id="S12T49U236">VA</span>*<span class="mxinfo " id="T4:U141">-<span class="var type1" id="S17T4U238">Q2</span></span></span>*<span class="mxinfo " id="T49:U143"><span class="var type1" id="S14T49U240">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T49:U145"><span class="mxinfo " id="T49:U146"><span class="var type1" id="S20T59U244">Rx_solved</span>(<span class="mxinfo " id="T50:U148">:</span>,<span class="mxinfo " id="T17:U149"><span class="mxinfo " id="T2:U150">19</span>:<span class="mxinfo " id="T2:U151">21</span></span>)</span> = <span class="mxinfo " id="T49:U152"><span class="mxinfo " id="T49:U153"><span class="var type1" id="S12T49U251">VA</span>*<span class="mxinfo " id="T4:U155">-<span class="var type1" id="S18T4U253">Q3</span></span></span>*<span class="mxinfo " id="T49:U157"><span class="var type1" id="S14T49U255">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo " id="T49:U159"><span class="mxinfo " id="T49:U160"><span class="var type1" id="S20T59U259">Rx_solved</span>(<span class="mxinfo " id="T50:U162">:</span>,<span class="mxinfo " id="T50:U163">22:24</span>)</span> = <span class="mxinfo " id="T49:U164"><span class="mxinfo " id="T49:U165"><span class="var type1" id="S12T49U266">VA</span>*<span class="mxinfo " id="T4:U167">-<span class="var type1" id="S19T4U268">Q4</span></span></span>*<span class="mxinfo " id="T49:U169"><span class="var type1" id="S14T49U270">VB</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">[<span class="mxinfo " id="T2:U171"><span class="mxinfo " id="T2:U172">~</span></span>, <span class="mxinfo " id="T4:U173"><span class="var type1" id="S22T4U275">Na</span></span>, <span class="mxinfo " id="T2:U175"><span class="mxinfo " id="T2:U176">~</span></span>, <span class="mxinfo " id="T25:U177"><span class="var type1" id="S23T25U277">pa</span></span>] = <span class="fcn" id="F673N8:B279">param_extract</span>(<span class="var type1" id="S3T28U280">MeanA</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">[<span class="mxinfo " id="T2:U180"><span class="mxinfo " id="T2:U181">~</span></span>, <span class="mxinfo " id="T4:U182"><span class="var type1" id="S25T4U285">Nb</span></span>, <span class="mxinfo " id="T2:U184"><span class="mxinfo " id="T2:U185">~</span></span>, <span class="mxinfo " id="T25:U186"><span class="var type1" id="S26T25U287">pb</span></span>] = <span class="fcn" id="F673N8:B289">param_extract</span>(<span class="var type1" id="S4T28U290">MeanB</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo " id="T25:U189"><span class="var type1" id="S27T25U293">na</span> = <span class="mxinfo " id="T25:U191"><span class="fcn" id="F633N12:B295">so3_vec</span>(<span class="var type1" id="S22T4U296">Na</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo " id="T25:U193"><span class="var type1" id="S29T25U299">nb</span> = <span class="mxinfo " id="T25:U195"><span class="fcn" id="F633N12:B301">so3_vec</span>(<span class="var type1" id="S25T4U302">Nb</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line"><span class="comment">%min=inf;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T2:U197"><span class="var type1" id="S30T2U305">min2</span> = <span class="mxinfo " id="T2:U199">inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S32T2U310">i</span> = <span class="mxinfo " id="T2:U201">1</span>:8</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">    <span class="mxinfo " id="T67:U202"><span class="var type1" id="S33T67U316">tx_temp</span> = <span class="mxinfo " id="T67:U204"><span class="fcn" id="F789N12:B318">so3_vec</span>(<span class="mxinfo " id="T66:U205">(<span class="mxinfo " id="T71:U206"><span class="mxinfo " id="T69:U207">(<span class="mxinfo " id="T69:U208"><span class="mxinfo " id="T71:U209"><span class="mxinfo " id="T71:U210"><span class="mxinfo " id="T66:U211"><span class="var type1" id="S20T59U328">Rx_solved</span>(<span class="mxinfo " id="T50:U213">:</span>,<span class="mxinfo " id="T70:U214"><span class="mxinfo " id="T2:U215"><span class="mxinfo " id="T2:U216"><span class="mxinfo " id="T2:U217">3</span>*(<span class="mxinfo " id="T2:U218"><span class="var type1" id="S32T2U336">i</span>-<span class="mxinfo " id="T2:U220">1</span></span>)</span>+<span class="mxinfo " id="T2:U221">1</span></span>:<span class="mxinfo " id="T2:U222"><span class="mxinfo " id="T2:U223">3</span>*<span class="var type1" id="S32T2U341">i</span></span></span>)</span>'</span>*<span class="mxinfo " id="T4:U225"><span class="var type1" id="S5T45U343">SigA</span>(<span class="mxinfo " id="T50:U227">1:3</span>,<span class="mxinfo " id="T50:U228">1:3</span>)</span></span>*<span class="mxinfo " id="T66:U229"><span class="var type1" id="S20T59U351">Rx_solved</span>(<span class="mxinfo " id="T50:U231">:</span>,<span class="mxinfo " id="T70:U232"><span class="mxinfo " id="T2:U233"><span class="mxinfo " id="T2:U234"><span class="mxinfo " id="T2:U235">3</span>*(<span class="mxinfo " id="T2:U236"><span class="var type1" id="S32T2U359">i</span>-<span class="mxinfo " id="T2:U238">1</span></span>)</span>+<span class="mxinfo " id="T2:U239">1</span></span>:<span class="mxinfo " id="T2:U240"><span class="mxinfo " id="T2:U241">3</span>*<span class="var type1" id="S32T2U364">i</span></span></span>)</span></span>)^-1</span>*(<span class="mxinfo " id="T49:U243"><span class="mxinfo " id="T4:U244"><span class="var type1" id="S6T45U370">SigB</span>(<span class="mxinfo " id="T50:U246">1:3</span>,<span class="mxinfo " id="T50:U247">4:6</span>)</span>-<span class="mxinfo " id="T69:U248"><span class="mxinfo " id="T71:U249"><span class="mxinfo " id="T71:U250"><span class="mxinfo " id="T66:U251"><span class="var type1" id="S20T59U381">Rx_solved</span>(<span class="mxinfo " id="T50:U253">:</span>,<span class="mxinfo " id="T70:U254"><span class="mxinfo " id="T2:U255"><span class="mxinfo " id="T2:U256"><span class="mxinfo " id="T2:U257">3</span>*(<span class="mxinfo " id="T2:U258"><span class="var type1" id="S32T2U389">i</span>-<span class="mxinfo " id="T2:U260">1</span></span>)</span>+<span class="mxinfo " id="T2:U261">1</span></span>:<span class="mxinfo " id="T2:U262"><span class="mxinfo " id="T2:U263">3</span>*<span class="var type1" id="S32T2U394">i</span></span></span>)</span>'</span>*<span class="mxinfo " id="T4:U265"><span class="var type1" id="S5T45U396">SigA</span>(<span class="mxinfo " id="T50:U267">1:3</span>,<span class="mxinfo " id="T50:U268">4:6</span>)</span></span>*<span class="mxinfo " id="T66:U269"><span class="var type1" id="S20T59U404">Rx_solved</span>(<span class="mxinfo " id="T50:U271">:</span>,<span class="mxinfo " id="T70:U272"><span class="mxinfo " id="T2:U273"><span class="mxinfo " id="T2:U274"><span class="mxinfo " id="T2:U275">3</span>*(<span class="mxinfo " id="T2:U276"><span class="var type1" id="S32T2U412">i</span>-<span class="mxinfo " id="T2:U278">1</span></span>)</span>+<span class="mxinfo " id="T2:U279">1</span></span>:<span class="mxinfo " id="T2:U280"><span class="mxinfo " id="T2:U281">3</span>*<span class="var type1" id="S32T2U417">i</span></span></span>)</span></span></span>)</span>)'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T3:U283"><span class="mxinfo " id="T2:U284">abs(<span class="mxinfo " id="T48:U285"><span class="mxinfo " id="T48:U286">det(<span class="mxinfo " id="T66:U287"><span class="var type1" id="S20T59U430">Rx_solved</span>(<span class="mxinfo " id="T50:U289">:</span>,<span class="mxinfo " id="T70:U290"><span class="mxinfo " id="T2:U291"><span class="mxinfo " id="T2:U292"><span class="mxinfo " id="T2:U293">3</span>*(<span class="mxinfo " id="T2:U294"><span class="var type1" id="S32T2U438">i</span>-<span class="mxinfo " id="T2:U296">1</span></span>)</span>+<span class="mxinfo " id="T2:U297">1</span></span>:<span class="mxinfo " id="T2:U298"><span class="mxinfo " id="T2:U299">3</span>*<span class="var type1" id="S32T2U443">i</span></span></span>)</span>)</span>-<span class="mxinfo " id="T2:U301">1</span></span>)</span>&lt;<span class="mxinfo " id="T2:U302">0.001</span></span>) &amp;&amp; (<span class="mxinfo " id="T3:U303"><span class="mxinfo " id="T2:U304">norm(<span class="mxinfo " id="T51:U305"><span class="var type1" id="S27T25U451">na</span>-<span class="mxinfo " id="T51:U307"><span class="mxinfo " id="T66:U308"><span class="var type1" id="S20T59U454">Rx_solved</span>(<span class="mxinfo " id="T50:U310">:</span>,<span class="mxinfo " id="T70:U311"><span class="mxinfo " id="T2:U312"><span class="mxinfo " id="T2:U313"><span class="mxinfo " id="T2:U314">3</span>*(<span class="mxinfo " id="T2:U315"><span class="var type1" id="S32T2U462">i</span>-<span class="mxinfo " id="T2:U317">1</span></span>)</span>+<span class="mxinfo " id="T2:U318">1</span></span>:<span class="mxinfo " id="T2:U319"><span class="mxinfo " id="T2:U320">3</span>*<span class="var type1" id="S32T2U467">i</span></span></span>)</span>*<span class="var type1" id="S29T25U468">nb</span></span></span>)</span>&lt;<span class="mxinfo " id="T2:U323">1.5</span></span>) &amp;&amp; (<span class="mxinfo " id="T3:U324"><span class="mxinfo " id="T2:U325">norm(<span class="mxinfo " id="T64:U326"><span class="var type1" id="S23T25U475">pa</span>-(<span class="mxinfo " id="T64:U328"><span class="mxinfo " id="T51:U329"><span class="mxinfo " id="T66:U330"><span class="var type1" id="S20T59U480">Rx_solved</span>(<span class="mxinfo " id="T50:U332">:</span>,<span class="mxinfo " id="T70:U333"><span class="mxinfo " id="T2:U334"><span class="mxinfo " id="T2:U335"><span class="mxinfo " id="T2:U336">3</span>*(<span class="mxinfo " id="T2:U337"><span class="var type1" id="S32T2U488">i</span>-<span class="mxinfo " id="T2:U339">1</span></span>)</span>+<span class="mxinfo " id="T2:U340">1</span></span>:<span class="mxinfo " id="T2:U341"><span class="mxinfo " id="T2:U342">3</span>*<span class="var type1" id="S32T2U493">i</span></span></span>)</span>*<span class="var type1" id="S26T25U494">pb</span></span>+<span class="mxinfo " id="T67:U345">(<span class="mxinfo " id="T4:U346"><span class="mxinfo " id="T4:U347">eye(3)</span>-<span class="mxinfo " id="T4:U348"><span class="var type1" id="S27T25U502">na</span>*<span class="mxinfo " id="T17:U350"><span class="var type1" id="S27T25U504">na</span>'</span></span></span>)*<span class="var type1" id="S33T67U505">tx_temp</span></span></span>)</span>)</span>&lt;<span class="var type1" id="S30T2U506">min2</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line">        <span class="comment">%min=norm(na-Rx_solved(1:3,1:3,i)*nb);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">        <span class="mxinfo " id="T2:U354"><span class="var type1" id="S30T2U509">min2</span> = <span class="mxinfo " id="T2:U356">norm(<span class="mxinfo " id="T64:U357"><span class="var type1" id="S23T25U513">pa</span>-(<span class="mxinfo " id="T64:U359"><span class="mxinfo " id="T51:U360"><span class="mxinfo " id="T66:U361"><span class="var type1" id="S20T59U518">Rx_solved</span>(<span class="mxinfo " id="T50:U363">:</span>,<span class="mxinfo " id="T70:U364"><span class="mxinfo " id="T2:U365"><span class="mxinfo " id="T2:U366"><span class="mxinfo " id="T2:U367">3</span>*(<span class="mxinfo " id="T2:U368"><span class="var type1" id="S32T2U526">i</span>-<span class="mxinfo " id="T2:U370">1</span></span>)</span>+<span class="mxinfo " id="T2:U371">1</span></span>:<span class="mxinfo " id="T2:U372"><span class="mxinfo " id="T2:U373">3</span>*<span class="var type1" id="S32T2U531">i</span></span></span>)</span>*<span class="var type1" id="S26T25U532">pb</span></span>+<span class="mxinfo " id="T67:U376">(<span class="mxinfo " id="T4:U377"><span class="mxinfo " id="T4:U378">eye(3)</span>-<span class="mxinfo " id="T4:U379"><span class="var type1" id="S27T25U540">na</span>*<span class="mxinfo " id="T17:U381"><span class="var type1" id="S27T25U542">na</span>'</span></span></span>)*<span class="var type1" id="S33T67U543">tx_temp</span></span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line">        <span class="mxinfo " id="T66:U384"><span class="var type1" id="S37T66U546">Rx</span> = <span class="mxinfo " id="T66:U386"><span class="var type1" id="S20T59U548">Rx_solved</span>(<span class="mxinfo " id="T50:U388">:</span>,<span class="mxinfo " id="T70:U389"><span class="mxinfo " id="T2:U390"><span class="mxinfo " id="T2:U391"><span class="mxinfo " id="T2:U392">3</span>*(<span class="mxinfo " id="T2:U393"><span class="var type1" id="S32T2U556">i</span>-<span class="mxinfo " id="T2:U395">1</span></span>)</span>+<span class="mxinfo " id="T2:U396">1</span></span>:<span class="mxinfo " id="T2:U397"><span class="mxinfo " id="T2:U398">3</span>*<span class="var type1" id="S32T2U561">i</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">        <span class="mxinfo " id="T66:U400"><span class="var type1" id="S37T66U565">Rx</span> = <span class="mxinfo " id="T4:U402">zeros(<span class="mxinfo " id="T2:U403">3</span>, <span class="mxinfo " id="T2:U404">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T67:U405"><span class="var type1" id="S33T67U572">tx_temp</span> = <span class="mxinfo " id="T67:U407"><span class="fcn" id="F789N12:B574">so3_vec</span>(<span class="mxinfo " id="T66:U408">(<span class="mxinfo " id="T71:U409"><span class="mxinfo " id="T69:U410">(<span class="mxinfo " id="T69:U411"><span class="mxinfo " id="T71:U412"><span class="mxinfo " id="T71:U413"><span class="var type1" id="S37T66U583">Rx</span>'</span>*<span class="mxinfo " id="T4:U415"><span class="var type1" id="S5T45U585">SigA</span>(<span class="mxinfo " id="T50:U417">1:3</span>,<span class="mxinfo " id="T50:U418">1:3</span>)</span></span>*<span class="var type1" id="S37T66U592">Rx</span></span>)^-1</span>*(<span class="mxinfo " id="T49:U420"><span class="mxinfo " id="T4:U421"><span class="var type1" id="S6T45U598">SigB</span>(<span class="mxinfo " id="T50:U423">1:3</span>,<span class="mxinfo " id="T50:U424">4:6</span>)</span>-<span class="mxinfo " id="T69:U425"><span class="mxinfo " id="T71:U426"><span class="mxinfo " id="T71:U427"><span class="var type1" id="S37T66U608">Rx</span>'</span>*<span class="mxinfo " id="T4:U429"><span class="var type1" id="S5T45U610">SigA</span>(<span class="mxinfo " id="T50:U431">1:3</span>,<span class="mxinfo " id="T50:U432">4:6</span>)</span></span>*<span class="var type1" id="S37T66U617">Rx</span></span></span>)</span>)'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line"><span class="mxinfo " id="T67:U434"><span class="var type1" id="S38T67U620">tx</span> = <span class="mxinfo " id="T67:U436"><span class="mxinfo " id="T66:U437">-<span class="var type1" id="S37T66U623">Rx</span></span>*<span class="var type1" id="S33T67U624">tx_temp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line"><span class="mxinfo " id="T65:U440"><span class="var type1" id="S2T65U627">X</span> = <span class="mxinfo " id="T65:U442">[<span class="mxinfo " id="T73:U443"><span class="var type1" id="S37T66U630">Rx</span> <span class="var type1" id="S38T67U631">tx</span></span>; <span class="mxinfo " id="T74:U446"><span class="mxinfo " id="T17:U447">[<span class="mxinfo " id="T2:U448">0</span> <span class="mxinfo " id="T2:U449">0</span> <span class="mxinfo " id="T2:U450">0</span>]</span> <span class="mxinfo " id="T2:U451">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
